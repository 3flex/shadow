(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{308:function(e,n,t){"use strict";t.r(n);var a=t(14),s=Object(a.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"configuring-shadowed-dependencies"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#configuring-shadowed-dependencies"}},[e._v("#")]),e._v(" Configuring Shadowed Dependencies")]),e._v(" "),n("p",[e._v("Shadow configures the default "),n("code",[e._v("shadowJar")]),e._v(" task to merge all dependencies from the project's "),n("code",[e._v("runtimeClasspath")]),e._v(" configuration\ninto the final JAR.\nThe configurations from which to source dependencies for the merging can be configured using the "),n("code",[e._v("configurations")]),e._v(" property\nof the "),n("a",{attrs:{href:"http://imperceptiblethoughts.com/shadow/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("ShadowJar")]),n("OutboundLink")],1),e._v(" task type.")]),e._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[e._v("shadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  configurations "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("configurations"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("compileClasspath"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("p",[e._v("The above code sample would configure the "),n("code",[e._v("shadowJar")]),e._v(" task to merge dependencies from only the "),n("code",[e._v("compileClasspath")]),e._v(" configuration.\nThis means any dependency declared in the "),n("code",[e._v("runtimeOnly")]),e._v(" configuration would be "),n("strong",[e._v("not")]),e._v(" be included in the final JAR.")]),e._v(" "),n("blockquote",[n("p",[e._v("Note the literal use of "),n("code",[e._v("project.configurations")]),e._v(" when setting the "),n("code",[e._v("configurations")]),e._v(" attribute of a\n"),n("a",{attrs:{href:"http://imperceptiblethoughts.com/shadow/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("ShadowJar")]),n("OutboundLink")],1),e._v(" task.\nThis is "),n("strong",[e._v("required")]),e._v(". It maybe be tempting to specify "),n("code",[e._v("configurations = [configurations.compile]")]),e._v(" but this will not\nhave the intended effect, as "),n("code",[e._v("configurations.compile")]),e._v(" will try to delegate to the "),n("code",[e._v("configurations")]),e._v(" property of the\nthe "),n("a",{attrs:{href:"http://imperceptiblethoughts.com/shadow/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("ShadowJar")]),n("OutboundLink")],1),e._v(" task instead of the "),n("code",[e._v("project")])])]),e._v(" "),n("h2",{attrs:{id:"embedding-jar-files-inside-your-shadow-jar"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#embedding-jar-files-inside-your-shadow-jar"}},[e._v("#")]),e._v(" Embedding Jar Files Inside Your Shadow Jar")]),e._v(" "),n("p",[e._v("Because of the way that Gradle handles dependency configuration, from a plugin perspective, shadow is unable to\ndistinguish between a jar file configured as a dependency and a jar file included in the resource folder.  This means\nthat any jar found in a resource directory will be merged into the shadow jar the same as any other dependency.  If\nyour intention is to embed the jar inside, you must rename the jar as to not end with "),n("code",[e._v(".jar")]),e._v(" before the shadow task\nbegins.")]),e._v(" "),n("h2",{attrs:{id:"filtering-dependencies"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#filtering-dependencies"}},[e._v("#")]),e._v(" Filtering Dependencies")]),e._v(" "),n("p",[e._v("Individual dependencies can be filtered from the final JAR by using the "),n("code",[e._v("dependencies")]),e._v(" block of a\n"),n("a",{attrs:{href:"http://imperceptiblethoughts.com/shadow/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("ShadowJar")]),n("OutboundLink")],1),e._v(" task.\nDependency filtering does "),n("strong",[e._v("not")]),e._v(" apply to transitive dependencies.\nThat is, excluding a dependency does not exclude any of its dependencies from the final JAR.")]),e._v(" "),n("p",[e._v("The "),n("code",[e._v("dependency")]),e._v(" blocks provides a number of methods for resolving dependencies using the notations familiar from\nGradle's "),n("code",[e._v("configurations")]),e._v(" block.")]),e._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Exclude an Module Dependency")]),e._v("\ndependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  implementation "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:2.11.1'")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\nshadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  dependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("exclude")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:2.11.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Exclude a Project Dependency")]),e._v("\ndependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  implementation "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("project")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("':api'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\nshadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  dependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("exclude")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("project")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("':api'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("blockquote",[n("p",[e._v("While not being able to filter entire transitive dependency graphs might seem like an oversight, it is necessary\nbecause it would not be possible to intelligently determine the build author's intended results when there is a\ncommon dependency between two 1st level dependencies when one is excluded and the other is not.")])]),e._v(" "),n("h3",{attrs:{id:"using-regex-patterns-to-filter-dependencies"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#using-regex-patterns-to-filter-dependencies"}},[e._v("#")]),e._v(" Using Regex Patterns to Filter Dependencies")]),e._v(" "),n("p",[e._v("Dependencies can be filtered using regex patterns.\nCoupled with the "),n("code",[e._v("<group>:<artifact>:<version>")]),e._v(" notation for dependencies, this allows for excluding/including\nusing any of these individual fields.")]),e._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Exclude Any Version of a Dependency")]),e._v("\ndependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  implementation "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:2.11.1'")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\nshadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  dependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("exclude")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:.*'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("p",[e._v("Any of the individual fields can be safely absent and will function as though a wildcard was specified.")]),e._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Ignore Dependency Version")]),e._v("\ndependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  implementation "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:2.11.1'")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\nshadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  dependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("exclude")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("p",[e._v("The above code snippet is functionally equivalent to the previous example.")]),e._v(" "),n("p",[e._v("This same pattern can be used for any of the dependency notation fields.")]),e._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Ignoring An Artifact Regardless of Group")]),e._v("\ndependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  implementation "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:2.11.1'")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\nshadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  dependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("exclude")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("':log4j-core:2.11.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Excluding All Artifacts From Group")]),e._v("\ndependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  implementation "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:2.11.1'")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\nshadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  dependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("exclude")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[e._v("dependency")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:2.11.1'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(")")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])]),n("h3",{attrs:{id:"programmatically-selecting-dependencies-to-filter"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#programmatically-selecting-dependencies-to-filter"}},[e._v("#")]),e._v(" Programmatically Selecting Dependencies to Filter")]),e._v(" "),n("p",[e._v("If more complex decisions are needed to select the dependencies to be included, the\n"),n("a",{attrs:{href:"http://imperceptiblethoughts.com/shadow/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html#dependencies(Action%3CDependencyFilter%3E)",target:"_blank",rel:"noopener noreferrer"}},[n("code",[e._v("dependencies")]),n("OutboundLink")],1),e._v("\nblock provides a method that accepts a "),n("code",[e._v("Closure")]),e._v(" for selecting dependencies.")]),e._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[e._v("// Selecting Dependencies to Filter With a Spec")]),e._v("\ndependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  implementation "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j:log4j-core:2.11.1'")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n\nshadowJar "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n  dependencies "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n    exclude "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("{")]),e._v("\n      it"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(".")]),e._v("moduleGroup "),n("span",{pre:!0,attrs:{class:"token operator"}},[e._v("==")]),e._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[e._v("'org.apache.logging.log4j'")]),e._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("}")]),e._v("\n")])])])])}),[],!1,null,null,null);n.default=s.exports}}]);